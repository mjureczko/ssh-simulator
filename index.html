<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>SSH-Simulator by NetworkedAssets</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <link href="https://a248.e.akamai.net/assets.github.com/assets/github-64354b3684a175db223715fcd6748b0daf8aebbc.css" rel="stylesheet" type="text/css">
    <link href="https://a248.e.akamai.net/assets.github.com/assets/github2-883c2d036f95a0fb486a5d977a84cb0b91a58353.css" rel="stylesheet" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>SSH-Simulator</h1>
        <p>Simulator of ssh service</p>

        <p class="view"><a href="https://github.com/NetworkedAssets/ssh-simulator">View the Project on GitHub <small>NetworkedAssets/ssh-simulator</small></a></p>


        <ul>
          <li><a href="https://github.com/NetworkedAssets/ssh-simulator/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/NetworkedAssets/ssh-simulator/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/NetworkedAssets/ssh-simulator">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p><a href="http://www.networkedassets.com"><img src="http://www.networkedassets.com/wordpress/wp-content/uploads/2013/01/NA_weblogo.png" alt="NetworkedAssets GmbH"></a></p>

<h1>Introduction</h1>

<p>Does your application communicate through SSH? Do you want to ensure that these features are working properly in a number of more or less sophisticated test scenarios? If the answer is yes, then the SSH-Simulator can be very handy for you. SSH-Simulator is a simple, JUnit compatible tool for launching virtual devices, that communicate in SSH and automatically verifies the communication correctness.</p>

<p>The SSH-Simulator can be used in two ways. It is possible to launch it as an SSH server. In such case the simulator is waiting for incoming connections and when a client appears verifies whether the communication corresponds with a user defined schema, i.e. the simulator must be told which requests should arrive and how should they be responded - when something is going differently an error is reported. It is also possible (which is probably more interesting) to launch the SSH-Simulator in a JUnit test. In such scenario the simulator is launched and shut down in the context of a single test, and hence it is possible to define different communication scenarios for each test and release all resources instantly after test execution.
Getting started</p>

<p>The easiest way to add the SSH-Simulator to a project is to use Apache Maven. It is enough to add following entries to the pom.xml file:</p>

<p><em>Listing 1: SSH-simulator dependency</em></p>

<div class="highlight"><pre><span class="nt">&lt;dependency&gt;</span>
  <span class="nt">&lt;groupId&gt;</span>com.networkedassets<span class="nt">&lt;/groupId&gt;</span>
  <span class="nt">&lt;artifactId&gt;</span>ssh-simulator<span class="nt">&lt;/artifactId&gt;</span>
  <span class="nt">&lt;version&gt;</span>0.1<span class="nt">&lt;/version&gt;</span>
  <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>

<p>The SSH-Simulator tool is configured using XML files. The XML configuration file contains expected requests and the responses that will be generated by the simulator. The file can look as it is presented on Listing 2.</p>

<p><em>Listing 2: Configuration file</em></p>

<div class="highlight"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
 
<span class="nt">&lt;test_case</span> <span class="na">xmlns:tcs=</span><span class="s">"test_case_schema.xsd"</span>
    <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span> <span class="na">xmlns:xsd=</span><span class="s">"http://www.w3.org/2001/XMLSchema"</span>
    <span class="na">xmlns=</span><span class="s">"http://www.networkedassets.com/test_case_schema"</span><span class="nt">&gt;</span>
 
    <span class="nt">&lt;login&gt;</span>login<span class="nt">&lt;/login&gt;</span>
    <span class="nt">&lt;password&gt;</span>password<span class="nt">&lt;/password&gt;</span>
    <span class="nt">&lt;device_type&gt;</span>CNR<span class="nt">&lt;/device_type&gt;</span>
 
    <span class="nt">&lt;request</span> <span class="na">delay_in_ms=</span><span class="s">"3000"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;request_command&gt;</span>dhcp reload<span class="nt">&lt;/request_command&gt;</span>
        <span class="nt">&lt;response_message&gt;</span>
100 Ok
        <span class="nt">&lt;/response_message&gt;</span>
        <span class="nt">&lt;response_prompt&gt;</span>nrcmd&gt;$<span class="nt">&lt;/response_prompt&gt;</span>
    <span class="nt">&lt;/request&gt;</span>
<span class="nt">&lt;/test_case&gt;</span>
</pre></div>

<p>The configuration file contains a  entry that represents the sequence of requests and responses that should be executed during test. At the top of  node are credentials that the client should use to connect to the simulator followed by a . A number of device types are supported i.e. ASR, CMTS, CNR, Router7600. This parameter affects the behavior only slightly, namely simulator works like the selected device with respect to control characters (e.g. carriage return, echoes, etc.) Subsequently comes a series of  nodes (on the presented Listing there is only one) that define the expected client requests and instructs the simulator how should they be responded. The  node can have a delay_in_ms parameter. This parameter tells the simulator how long should he wait before sending the response (helpful in simulating long lasting commands). The  defines the content of expected client request;  stands for the response that will be send back to the client by the simulator; and eventually the  instructs how the command line prompt should look like. The configuration file should be saved in (src/test/resources/)TestCasesXmls directory.</p>

<p>When the XML configuration file is ready, it is enough to use it in a JUnit test case as it is presented on Listing 3.</p>

<p><em></em>Listing 3: Using SSH-Simulator in JUnit</em></p>

<div class="highlight"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyTest</span> <span class="kd">extends</span> <span class="n">SshSimulatorGenericTestCase</span> <span class="o">{</span>
    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">sampleTest</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">initializeNewSshServer</span><span class="o">(</span><span class="n">xmlConfigFileName</span><span class="o">,</span> <span class="s">"192.168.10.180"</span><span class="o">,</span> <span class="mi">22</span><span class="o">);</span>
        <span class="c1">//do the tests here</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>

<p>After test execution the SSH communication is automatically verified with respect to the given XML configuration. When it does not match, an ordinary JUnit test failure is reported. Typically the simulator is started on localhost (second parameter of the initializeNewSshServer method). If there is a need to have the SSH service available on different address, then the different address (e.g. 192.168.10.180) must be given as the second parameter and must be available on the machine where the simulator is started, e.g. as an additional network interface.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/NetworkedAssets">NetworkedAssets</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>
